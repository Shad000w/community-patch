<html>
 <head>
  <title>Community Patch 1.71 Documentation - Full</title>
   <style ref="text/css">
   p{font-size: medium; font-weight: normal;}
   ul{font-size: large; font-weight: bolder;}
   ol{font-size: large; font-weight: bolder;}
   li{font-size: medium; font-weight: normal;}     
   
   .red{color: #B00000;}
                                
   </style>
  </head>
 <body>
 <h1><a name="top">Community Patch Detailed Documentation</a></h1>
 <p>This is a detailed list of most changes coming with a Community patch. However not every change is listed here due to the space constraints - with the Community Patch 1.71, the ammount of changes grown to thousands. It is not possible to list every single change especially if that change is invisible to the player (such as correcting feats' toolset categories) or hardly describeable (such as tileset fixes). From this reason, sometimes a group of changes is simply summed up into one line such as: "Revisited and corrected all feat toolset categories". To list every single feat with the previous and new category simply isn't possible.</p>
 <p>However due to the significancy of the spell and script related changes there is a special documentation listing these changes. To see it, go <a href="index.html">back</a> to documentation index and select spell/script related changes. Note that a regular player should be satisfied with whats described below on this page.</p>
 <p>This readme applies for both version 1.70 and 1.71. The <span class="red">red</span> color means that the specific change/fix/feature applies only for the patch 1.71.</p>
  <ul>List of all documentation categories:
   <li><a href="#hakversion">Hak version</a></li>
   <li><a href="#familiar">Familiar&Companions; full notes</a></li>
   <li><a href="#creatures">Various creature fixes full notes</a></li>
   <li><a href="#itemprops">Itemproperties Expanded full notes</a></li>
   <li><a href="#client">Client enhancements</a></li>
   <li><a href="#traps">Trap fixes and new trap types</a></li>
   <li><a href="#builds">Character builds and gameplay concerned</a></li>
   <li><a href="#toolset">New features in toolset</a></li>
   <li><a href="#scripts">Scripting changes and improvements</a></li>
   <li><a href="#spellengine">New Spell Engine concept info</a></li>
   <li><a href="#nwnx">NWNX Patch plugin</a></li>
   <li><a href="#credits">Credits</a></li>
  </ul>
  <h2><a name="hakversion">Hak version </a> <span style="font-size: small;margin-top: -5px"><a href="#top">back to top</a></span></h2>
  <p>If you would want to force players to have the Community Patch in order to play on your server, you can add the patch170.hak (or patch171.hak respectively) into your module. Every player that installed the Community Patch will have this hak. You may place this hak at lowest position in your hak list for compatibility reasons, but then to keep access to the new features you will need to merge all 2DA files inside hak. Or you can place it at the top of the list and use it for a server-side only stuff, but then merging the 2DA files is a must <i>(unless you delete them)</i>.</p>
  <p>This is of course <b>optional</b>. It does contain a fix for DOA Base Item issue <i>(described in first section of this readme)</i>, and as an additional feature you gain access to several bioware secret/unreleased creatures. Some of them are bit unfinished, but mostly useable, many already appeared in CEP, they are occupying lines 307 to 322.</p>
  <ul>
   <li>Belker</li>
   <li>Goblin <i>(without quiver)</i></li>
   <li>Goblin king</li>
   <li class="red">Bargest</li>
   <li class="red">Greater barghest</li>
   <li class="red">Minogon</li>
   <li class="red">Green slaad</li>
   <li class="red">Ogre</li>
   <li class="red">Cow</li>
   <li class="red">Lizardfolk shaman</li>
   <li class="red">Wraith spider</li>
   <li class="red">Bombarier beetle</li>
   <li class="red">Vampiric mist</li>
   <li class="red">Cat, cougar</li>
   <li class="red">Rakshasa wolf, female</li>
   <li class="red">Rakshasa bear, female</li>
   <li class="red">Ochre jelly, large 2</li>
   <li class="red">Ochre jelly, medium 2</li>
  </ul>
  <p>All the appearances are listed in toolset at the top of the list, with the prefix "1.70:". Some creatures also has a blueprint in standard palette:</p>
  <ul>
   <li>Belker: listed under elementals, CR 7</li>
   <li>Goblin: listed under humanoids/goblinoids, latest in the list</li>
   <li>Goblin king: listed under humanoids/goblinoids</li>  
   <li class="red">Barghests: listed under shapechangers</li>
   <li class="red">Bombardier beetle: listed under insect/beetles aka scorching beetle, strong fire beetle with fire aura, fire breath and 4 fire bolts</li>
   <li class="red">Lizardfolk shaman: listed under humanoids/lizardfolk, this is a druid shaman with sickle, latest in the list</li>
  </ul>
  <p>HAK version also contains improves spell casting/targetting.</p>
  <ul>
   <li>Meteor Swarm doesn't need targetting. <i>(in order to make a casting of this spell more friendly)</i></li>
   <li>Invisibility Purge, Firestorm, Storm of Vengeance and Healing Circle can be cast on items, thus allowing default crafting.</li> 
  </ul>
  <p class="red">Extra features in HAK version added in the 1.71 release:</p>
  <ul class="red">
   <li>Default aura's circles made invisible. <i>Each aura has a default circle visual effect that will however disappear when player change area. To fix this, community patch added extra circle into spellscripts so player could notice there are actually two circles after initial casting. This feature is in HAK version to maintain backwards compatibility with a PWs not using community patch)</i></li>
   <li>Added stackable miscelanious baseitems. Each miscelanious item has a second version that is in toolset named the same but listed below original baseitem and this version has a stacksize of 10 pieces. This is extra helpful for custom content.</li>
  </ul>
  <p>Of course, this content will be useable only if your hak packs above patch170 <i>(or patch171)</i> doesn't contain appearance.2da, spells.2da and baseitems.2da files. If they do, then in order to gain access to these creatures you have to merge these 2DA files in your top hak with a Patch's hak version. See Auto 2DA Merger in Builder's resources for help with this task.</p>                                                                                                                                                                                                     
  <h2><a name="familiar">Familiar&Companions; full notes</a> <span style="font-size: small;margin-top: -5px"><a href="#top">back to top</a></span></h2>
  <p>This fixes properties of the wizard/sorcerer Fire Mephit, Hell Hound, and Faerie Dragon familiars, as well as a number of similar bugs affecting familiars and animal companions.</p>
  <p>Bugs Fixed</p>
  <ul>
   <li>Level 35-40 Fire Mephit familiar missing attack properties <i>(nw_fm_fire**)</i></li>
   <li>Level 35-40 Hell Hound familiar missing attack properties <i>(nw_fm_hell**)</i></li>
   <li>Level 35-40 Faerie Dragon familiar missing attack properties <i>(x0_fm_fdrg**)</i></li>
   <li>Level 15 &amp; 16 Dire Wolf companion [various fixes] <i>(nw_ac_dwlf**)</i></li>
   <li>Level 8, 10, 14, 18, 35-40 Giant Spider companion [various fixes] <i>(nw_ac_spid**)</i></li>
   <li>Level 40 Hawk companion missing items <i>(nw_ac_hawk40)</i></li>
   <li>Level 12 &amp; 14 Wolf companion [various fixes] <i>(nw_ac_wolf**)</i></li>
   <li>Level 7 Imp familiar has Ice Mephit properties <i>(nw_fm_imp07)</i></li>
   <li>Eyeball Familiar levels 21-25 - reduced uses per day of eye-rays and spells to match earlier and later levels. </li>
   <li>Faerie Dragon Familiar level 19 - removed erroneous Daze Bolt, replaced with normal 2/day Improved Invisibility and 2/day Confusion Bolt.</li>      
   <li>Pixie Familiar level 17 - Wisdom raised from 12 to 15 to match earlier and later levels.</li>
   <li>Hell Hound Familiar levels 13-14 - upped Fire Breath from 2/day to 3/day to match earlier and later levels.</li>
   <li>Bat Familiar level 4 - added Weapon Finesse feat to match all other levels.</li>
   <li>Fixed exploit in familiar conversation that allowed unlimited instant fullhealing of given target.</li>
  </ul>
  <p>See the NWNWiki for full details of <a href="https://web.archive.org/web/20170227224729/http://nwn.wikia.com/wiki/Category:Familiars" target="blank">familiars</a> and <a href="https://web.archive.org/web/20170227224729/http://nwn.wikia.com/wiki/Category:Animal_companions" target="blank">animal companions</a>.</p>
  <h2><a name="creatures">Various creatures fixes full notes</a> <span style="font-size: small;margin-top: -5px"><a href="#top">back to top</a></span></h2>
  <p>Community patch fixes several creatures, but since this is fixed in creature's blueprint, it will work only in case that you spawn default creature either via bioware encounter or custom spawn system (like NESS). It doesn't take effect if you were doing copies from default creatures or you placed the creature into area before you installed Community patch. In these cases, you should fix your copies manually.</p>
  <ul>
   <li>Wraith, <span class="red">Wraith spider</span> – alignment corrected to lawful evil <i>(as per DnD references)</i></li>
   <li>Spectre – added Blind-fight and Improved Initiative feats <i>(as per DnD references)</i></li>
   <li class="red">Revenant - alignment corrected to neutral evil <i>(as per DnD references)</i></li>
   <li>Skeleton mage - alignment corrected to neutral evil <i>(was true neutral)</i></li>
   <li>healing spells were replaced for harming spells from Baelnorn, Dracolich, Vampire Priest <i>(so they won't harm themselves anymore)</i></li>
   <li>Formian queen speed changed from immobile to very slow. <i>(In order to fix bug AI that can't handle immobile creatures)</i></li>
   <li>removed companion dialog from summoned Elder Air Elemental, Ghoul, Ghast</li>
   <li>Lizardfolk Shaman (A) blueprint name fixed</li>
   <li>Halaster's CR in palette have been fixed <i>(was 229)</i> and immortality was removed from him</li>
   <li>several creatures added missing incorporeal flag: Allip and Summoned creatures: spectre, wraith, shadow, shadow lord and shadow fiend</li>
   <li>fixed incorporeal flag on spectre summoned from Pale Master feat</li>
   <li>fixed special AI for summoned shadow from SD feat</li>
   <li>several creature's AI level set to high: Halaster, Masterius, G'Zhorb, Demilich, Lich (21CR), Prismatic dragon and Harat</li>
   <li>removed Spell Mantle from demilich's spell selection <i>(demilich is immune to all spells so whats the point?)</i></li>
   <li>all cobras racial type fixed <i>(from reptilian humanoids to animal)</i></li>
   <li>ogre chieftant <i>(1.69 version)</i> blueprint fixed <i>(removed reference to non-existant armor)</i></li>
   <li class="red">Badger dexterity and skills corrected <i>(dex -&gt; 17, lore, taunt -&gt; spot,listen)</i></span></li>
   <li class="red">Jaguar, cougar, leopard and air and dust mephit skills corrected <i>(open lock -&gt; move silently)</i></li>
   <li class="red">Summoned red slaad's alignment corrected to chaotic neutral</li>
   <li class="red">Disease red slaad's alignment corrected to chaotic neutral</li>
   <li class="red">Half-fiend warrior's electrical immunity corrected to 100%</li> 
   <li class="red">Gelatinous cube - added missing blindsight ability <i>(usual for all oozes)</i></li>
   <li class="red">Removed inappropriate items from Mindflayer venerator.</li>
   <li class="red">Stealth variable fixed on all cobras.</li>
   <li class="red">Added missing soundset to the celestial avenger and half celestial warrior creatures.</li>   
  </ul>
  <p>Creature weapon/skin based creature changes; these changes takes effect even if you made a copy of creature, as long as yours copy uses default items.</p> 
  <ul>
   <li>Added missing death immunity to several undead creatures.</li>
   <ul>
    <li>Demillich</li>
    <li class="red">Alhoon</li>
    <li class="red">Dracolich <i>(pre HotU skin)</i></li>
    <li class="red">Revenant</li>
    <li class="red">all liches</li> 
    <li class="red">all cursts</li>
    <li class="red">Masterius</li></div>
   </ul>
   <li>Giants and ogres now hold in their hand a weapon appropriate to their size direness. <i>(New "natural" club model from 1.69)</i></li>
   <li class="red">Added mising skin to the widow Hagatha and curst ranger. <i>(undead traits as per theirs racial type)</i></li>
   <li class="red">Added mising skin to the gelatinous cube. <i>(ooze traits as per its racial type)</i></li>
   <li class="red">Added missing weapons to the curst ranger <i>(longbow, poison arrows, shortsword)</i> and curst rogue <i>(dual wield shortswords)</i>.</span></li>
   <li class="red">Added missing weapons to the vampire mage <i>(+1 dagger)</i> and vampire rogue <i>(dual wield +2 shortswords)</i>.</li>
   <li class="red">Added usual undead immunities into the Wraith spider skin <i>(as per its racial type)</i>.</li>
   <li class="red">Corrected Helmed and Battle horror's spell immunities. These constructs are now immune to the fireball, cone of cold, lightning bolt and magic missile as intented.</li>
  </ul>  
  <p>Model based creature changes; these are client-side, so they take effect always.</p> 
  <ul>
   <li>Drider close attack animation fix</li>
   <li>Gorgon and dire boar uv mapping fix</li>
   <li>Nymph's hair recolored to silver to match her portrait.</li> 
  </ul>
  <p>Script and 2DA based creature changes:</p>  
  <ul>
   <li>updated flying status on few creatures missing it (parrot, seagull, G'Zhorb, Halaster, Masterius)</li>
   <li>flying creatures are now immune to the grease, spike growth and caltrops effects</li>
   <li>oozes and several water breathing creatures are now immune to the drowning (sea hag, sahuagin, water and ooze mephits, black, green, bronze and gold wyrmlings and dragons)</li>
   <li>benefits for incorporeal creatures are now supernatural, thus they won't disappear after (forced) rest, <span class="red">also they are now immune to the effect of a knockdown and entangle</span></li>
   <li class="red">added missing petrify immunity to the Lich appearance</li>
   <li class="red">half-elves were given immunity to Undead graft.</li>
   <li class="red">shifter's spectre polymorph will retain the bonuses of being incorporeal</li>
   <li class="red">blinded, sightless creatures <i>(namely oozes)</i> and creatures under effect of darkness are now immune to all gaze attacks.</li>
   <li>Shadow's special AI rewritten to make his attack more effective and to fix an issue when shadow stopped attacking.</li>
   <li class="red">Beholders' AI significally improved with many issues corrected. Beholders can also use fear ray now.</li>
   <li class="red">Helmed Horror will not leave footprints anymore.</li>
   <li class="red">Ambient sounds of the Will-O-Wisp and Lanter Archon changed to new, more positive one instead of the spectre sounds (Twisted_Euphoria).</li>      
  </ul>
  <h2><a name="client">Client enhancements</a> <span style="font-size: small;margin-top: -5px"><a href="#top">back to top</a></span></h2>
  <p>There are notable client-side enhancements, such as graphical improvements, model corrections, tile corrections, tintable heads and description corrections.</p>
  <h3><a name="widget">PC Widget Tool</a></h3>
  <p>The most important for a player playing singleplayer modules is the PC Widget tool. This item will open a conversation that allows to turn on/off most used features from CP. You can spawn this item via console, using "dm_spawnitem 70_pcwidget" command. Don't forget to turn <a href="https://web.archive.org/web/20170227224729/http://nwn.wikia.com/wiki/Debug_mode">DebugMode</a> on.</p>
  <h3>Graphical improvements</h3>
  <ul>
   <li>Hundreds tile fixes and improvements containing these changes: tilefading corrections, walkmesh, pathfinding and visibility corrections, tile lights and animations corrections, edge tile corrections, missing polygon corrections.</li>
   <li>Several special spell icons changed to better suit the spell category or benefits. This namely affects ioun stones, the icon that appears in item subradial/quickbar.</li>
   <li>Added custom effect icons from Mordaedil and the PRC team, for effects with shared icon. This improvement allows players to easier determine the effects they are subject to.</li>
   <li>Added custom emote icons from The Amethyst Dragon.</li>
   <li>Added custom walking icon instead of the default "star" icon.</li>
   <li>Fixed the black background of numerous spell scroll icons.</li>
   <li>Added nicer hands and foots models from Kurairyu and NWNEnhanced team.</li>
   <li>Added colored lips/eyes/eyebrows from DeathFace.</li>
   <li>Fixed textures on five large shields from patch 1.69 (all had same "deer" texture).</li>
   <li>Fixed oversized "umberhulkish" gnome shin and forearms.</li>
   <li>Linu head clipping issue fixed.</li>
   <li>Large number of character model parts for large phenotype modified and shrinked to avoid clipping and overlapping issues.</li>
   <li class="red">Added tree foliage from helvene into trees in forest tileset. Unlike foliage from DLA that many are used to, this one properly fades out.</li> 
   <li class="red">Added missing tilefade feature into all placeable trees from patch 1.69.</li>
   <li class="red">Added missing tilefade feature into tree terrain in Castle/Rural tileset.</li>
   <li class="red">Colored class icons from BoomWav.</li>
   <li class="red">Colored skill icons from BoomWav.</li>
   <li class="red">Colored clerical domain icons from Q-Necron.</li>
   <li class="red">Colored spell icons (gen.2) from The Amethyst Dragon, note that several spell icons uses brand new image.</li>
   <li class="red">Removed flare from the light sources inside tiles (<a href="https://web.archive.org/web/20170227224729/http://social.bioware.com/forum/1/topic/191/index/9583912/1#15343818">link</a> for explanation and images).</li>
   <li class="red">Added the "<a href="https://web.archive.org/web/20170227224729/http://social.bioware.com/forum/1/topic/191/index/15366941#15367328">BioWater Patch</a>" for 1.69 tilesets from Chaos Theocrat to improve game performancy around water.</li>
   <li class="red">Added player character model <a href="https://web.archive.org/web/20170227224729/http://social.bioware.com/forum/1/topic/191/index/7236394#7268261">fix to maintain NO position or rotation keys for Impact node</a>.</li>
   <li class="red">Fixed client <a href="https://web.archive.org/web/20170227224729/http://social.bioware.com/forum/1/topic/193/index/13781567">bug with active domains and custom feats in radial menu</a>.</li>
  </ul>
  <h3>Tintable heads details</h3>
  <p>This feature adds colored eyes, lips and eyebrows and stubble. Note that this doesn't work on heads from CEP and from other sources (their job to update it).</p>
  <ul>
   <li>Eyebrows and stubble color match hair color.</li>
   <li>Eyes color match Tatoo1 color.</li>
   <li>Lips color match Tatoo2 color. Male heads do not have this feature.</li>
  </ul>
  <h3>Notable description corrections</h3>
  <p>There are much more corrections than listed, but those are only minor ones such as removing double spaces, extra line breaks, etc. These minor corrections differ in various translations and community patch correct also translation-specific mistakes.</p>
  <p>The changes listed below are correcting the feat, spell, skill and item descriptions to match ingame implementation, but only changes that are not coming from the community patch. Of course, several spell's description has been updated upon new implementation that comes with community patch, but since these changes are described on other places in this readme, they are not listed again here.</p>
  <ul>
   <li>A game load hints related to legacy Bioware site and guilds has been updated and points into new NWN websites ran by NWN community - <a href="www.neverwinternights.info">www.neverwinternights.info</a>.</li>
   <li>Corrected many spells' innate level, school, descriptor, area of effect, duration and whether spell resistance applies to match ingame implementation.</li>
   <li>Good aim feat works also with a sling.</li>
   <li>Devastating critical feat does not require weapon focus as prerequisite.</li>
   <li>Epic dodge feat does not require dodge as prerequisite.</li>
   <li>Artist feat adds a +2 bonus to the persuade skill as well. Also, prerequisities now list need for a perform skill.</li>
   <li>Stonecunning feat works in underground areas, not in any interiors.</li>
   <li>Thundering rage chance to trigger deafness effect corrected to 25%.</li>
   <li>Terrifying rage fear duration corrected to 1d3rounds.</li>
   <li>Cloud of bewilholdement affect all creatures in area of effect, not just enemies.</li>
   <li>Corrected damage calculation for a Creeping doom spell.</li>
   <li>Removed reference to the ranged touch attack from the Feeblemind spell.</li>  
   <li>Dispel DC changed to 12+spell caster level.</li>
   <li>Purple dragon knight feats' feedback externalised in order to make it multilanguaged.</li>
   <li class="red">Favored enemy improves for harper scout as well. Also, corrected a level where harper can take second favored enemy to 5.</li>
   <li class="red">Alchemical fire on-hit damage corrected to 1d4+1.</li>
   <li class="red">Storm of vengeance's electrical damage ammount corrected to 6d6.</li>   
   <li class="red">Lance critical hit multiplier corrected to x3.</li>
   <li class="red">Sun domain benefits corrected - the dices were listed in reversed order.</li>  
  </ul>
  <h3>Various other client side improvements and corrections</h3>
  <ul>
   <li>Recommended starting abilities for each class has been rebalanced to better suit each class focus.</li>
   <li>Removed annoying sound when firing elemental projectiles or firing from ranged weapon with elemental damage.</li>
   <li>Loud sounds from patch 1.69 were deadened a bit (golems soundset, crystal material -5dB).</li>
   <li>Dumb hero voiceset fixed - cuss wasn't available.</li>
   <li class="red">Corrected two female voicesets that appeared in male list.</li>
   <li class="red">Nonexistant sound reference of 'negative damage hit' visual effect fixed.</li>
   <li class="red">Negative damage hit visual effect from weapons changed from electrical to <i>real</i> negative. <i>(Caution: this is serverside actually, be sure your players have a CP installed or distribute them CP's visualeffects.2DA in your haks!)</i></li>
  </ul>
 <h2><a name="traps">Trap fixes and new trap types</a> <span style="font-size: small;margin-top: -5px"><a href="#top">back to top</a></span></h2>
 <p>Default traps were not very balanced and they suffered by various issues. The most known is probably fact that traps do affect also npcs, so if there is unlimited aoe trap, best lightning one, player can trigger it willingly in order to hurt his enemy, because with improved evasion and decent saves there is almost no chance that this trap will hurt player's character. This "feature" was however kept.</p>
 <ul>fixes to trap scripts:
   <li>Minor cold trap - fixed visual effect <i>(was fire)</i></li>
   <li>Fire traps (all) - old evasion behaviour <i>(now when evasion was applied, it will appear also in log)</i></li>
   <li>Tangle traps (all) - was missing target check, trap could affect party members on low difficulty</i></li>
   <li>Spike Traps</li>
   <ul>
    <li>DC was same <i>(15)</i> for all spike traps, now (minor 15, average 18, strong 21, deadly 30)</li>
    <li>impact VFX will now appear always <i>(didn't if target avoided damage via evasion)</i></li>
   </ul>
   <li>Sonic traps (except epic and deadly)</li>
   <ul>
    <li>was missing target check, trap could affect party members on low difficulty</li>
    <li>all targets in aoe took the same damage <i>(only minor version)</i></li>
   </ul>
   <li>Electrical traps</li>
   <ul>
    <li>old evasion behaviour <i>(now when evasion was applied, it will appear also in log)</i></li>
    <li>all secondary targets took the same damage</li>
    <li>could affect one more secondary target, than intended</li>
    <li>will make a lightning beams even on those who do not take any damage and on the first target</li>
    <li>saving throw subtype changed to traps <i>(to unify with other traps)</i></li>
   </ul>   
  </ul> 
  <p>Except that, there are new "traps" comming with the patch. They are not included in trigger palete, because they are actually only scripts. Thats in order not to demand new lines in NWN Text Table. So currently, to set new trap from this patch, you need to set <i>any</i> trap on desired object/at location and then go into properties on Trap tab. You should set the closest default trap in the field Trap Type, because if player try to recover trap, the trap that will appear in his inventory is defined from this field. You should also change the name (Basic tab), because if player can see the trap and gets damaged, he could seen "Average frost trap" when, he actually triggered "Weak fire trap"...</p>
  <p>Now move into OnTrapTriggered field and write the new trap <b>script name</b> from list below <i>(<a href="screenshots/newtrapsettings.jpg" target="_blank">example</a>)</i>. If you choose adjustable trap type, you need to set some variables in Advanced tab, variables button. Variables for adjustable traps are explained <a href="#adjustabletraps">below</a>.</p>
  <table border="1" cellpadding="6" cellspacing="1">    
  <tr>
   <td><b>Script name</b></td>
   <td><b>(Internal) Trap name</b></td>
   <td><b>Short description</b></td>
  <tr>
  <tr>
   <td>70_t1_acidadjst</td>
   <td>Adjustable Acid Blob Trap</td>
   <td>Reflex save vs paralyse, acid damage without save.</td>
  </tr>
  <tr>
   <td>70_t1_acidweak</td>
   <td>Weak Acid Blob Trap</td>
   <td>1d6 acid, reflex save vs DC 9 or paralysed for 1 round</td>
  </tr>
  <tr>
   <td>70_t1_acidepic</td>
   <td>Epic Acid Blob Trap</td>
   <td>25d6 acid, reflex save vs DC 30 or paralysed for 5 rounds</td>
  </tr>
  <tr>
   <td>70_t1_coldadjst</td>
   <td>Adjustable Frost Trap</td>
   <td>Fort save vs paralyse, cold damage without save..</td>
  </tr>    
  <tr>
   <td>70_t1_coldweak</td>
   <td>Weak Frost Trap</td>
   <td>1d4 cold, fort save vs DC 8 or paralysed for 1 round</td>
  </tr>  
  <tr>
   <td>70_t1_elecadjst</td>
   <td>Adjustable Electric Trap</td>
   <td>Reflex save versus damage, evasion is applicable.
After struck original target, trap will affect also number of secondary targets.</td>
  </tr>  
  <tr>
   <td>70_t1_elecweak</td>
   <td>Weak Electric Trap</td>
   <td>2-11 damage, reflex DC 9 evasion allowed, one secondary target</td>
  </tr>   
  <tr>
   <td>70_t1_fireadjst</td>
   <td>Adjustable Fire Trap</td>
   <td>Adjustable aoe fire trap. Reflex save versus damage, evasion is pplicable.</td>
  </tr>  
  <tr>
   <td>70_t1_fireweak</td>
   <td>Weak Fire Trap</td>
   <td>3d2 fire damage to all in aoe, reflex save vs DC 10 evasion allowed</td>
  </tr>      
  <tr>
   <td>70_t1_gasepic</td>
   <td>Epic Gas Trap</td>
   <td>Creates a  5m poison radius gas cloud that poisons all creatures entering
the area with Gargantual spider venom (DC 29, STR decrease).</td>
  </tr>  
  <tr>
   <td>70_t1_gasweak</td>
   <td>Weak Gas Trap</td>
   <td>Creates a  5m poison radius gas cloud that poisons all creatures entering
the area with random (but only one per trap instance) poison from this list:
   <table>
   <tr>
    <td>Poison name</td>
    <td>DC</td>
    <td>Ability</td>
    <td>2. roll</td>
   </tr>
   <tr>
    <td>Striped toadstool</td>
    <td>11</td>
    <td>WIS</td>
    <td>-</td>
   </tr>
   <tr>
    <td>Nightshade</td>
    <td>10</td>
    <td>DEX</td>
    <td>-</td>
   </tr>
   <tr>
    <td>Black adder venom </td>
    <td>12</td>
    <td>-</td>
    <td>STR</td>
   </tr>
   <tr>
    <td>Bloodroot</td>
    <td>12</td>
    <td>WIS</td>
    <td>CON</td>
   </tr>
   <tr>
    <td>Tiny spider venom</td>
    <td>11</td>
    <td>STR</td>
    <td>STR</td>
   </tr>
   <tr>
    <td>Ettercap venom</td>
    <td>13</td>
    <td>DEX</td>
    <td>DEX</td>
   </tr>                  
   </table>
   </td>
  </tr> 
  <tr>
   <td>70_t1_holyadjst</td>
   <td>Adjustable Holy Trap</td>
   <td>Adjustable single target holy trap. Just damage without save, undead takes +50% more damage.</td>
  </tr>  
  <tr>
   <td>70_t1_holyepic</td>
   <td>Epic Holy Trap</td>
   <td>35d10 to undead, 20d4 to anyone else, no save allowed</td>
  </tr>  
  <tr>
   <td>70_t1_holyweak</td>
   <td>Weak Holy Trap</td>
   <td>3d8 to undead, 1d4 to anyone else, no save allowed</td>
  </tr> 
  <tr>
   <td>70_t1_negadjst</td>
   <td>Adjustable Negative Energy Trap</td>
   <td>Adjustable single target negative trap. Fort save vs adjustable draining, undead heals by o 50% of intented damage instead.</td>
  </tr>                
  <tr>
   <td>70_t1_negepic</td>
   <td>Epic Negative Energy Trap</td>
   <td>35d6 negative to non-undead, fort save vs DC 30 or drain -2d2 levels,
undeads are healed for 20d6 hitpoints</td>
  </tr>  
  <tr>
   <td>70_t1_negweak</td>
   <td>Weak Negative Energy Trap</td>
   <td>2d3 negative to non-undead, fort save vs DC 8 or drain -1 str permanently, undeads are healed for 1d10 hitpoints</td>
  </tr>         
  <tr>
   <td>70_t1_soncadjst</td>
   <td>Adjustable Sonic Trap</td>
   <td>Adjustable aoe sonic trap. Will save vs stun, sonic damage without save.</td>
  </tr>  
  <tr>
   <td>70_t1_soncweak</td>
   <td>Weak Sonic Trap</td>
   <td>1d4 sonic to all in aoe, will save vs DC 7 or stunned for 1 round</td>
  </tr>    
  <tr>
   <td>70_t1_spikeadjst</td>
   <td>Adjustable Spike Trap</td>
   <td>Adjustable single target spike trap. Reflex save versus damage, evasion is applicable.</td>
  </tr>  
  <tr>
   <td>70_t1_spikeepic</td>
   <td>Epic Spike Trap</td>
   <td>55d6 damage, reflex save vs DC 35, evasion allowed</td>
  </tr>     
  <tr>
   <td>70_t1_spikeweak</td>
   <td>Weak Spike Trap</td>
   <td>2d3 damage, reflex save vs DC 9, evasion allowed</td>
  </tr>      
  <tr>
   <td>70_t1_splshadjst</td>
   <td>Adjustable Acid Splash Trap</td>
   <td>Adjustable single target acid trap. Reflex save versus damage, evasion is applicable.</td>
  </tr>  
  <tr>
   <td>70_t1_splshepic</td>
   <td>Epic Acid Splash Trap</td>
   <td>16d8 acid, reflex save DC 30 evasion allowed</td>
  </tr>     
  <tr>
   <td>70_t1_splshweak</td>
   <td>Weak Acid Splash Trap</td>
   <td>2d4 acid, reflex save DC 10 evasion allowed</td>
  </tr>   
  <tr>
   <td>70_t1_swingadjst</td>
   <td>Adjustable <a href="#swingingblade">Swinging Blade Trap</a></td>
   <td>Adjustable single target swinging blade trap. Twice reflex save versus damage, evasion is applicable.</td>
  </tr>  
  <tr>
   <td>70_t1_swingavg</td>
   <td>Average <a href="#swingingblade">Swinging Blade Trap</a></td>
   <td>twice 3d8 damage, reflex save vs DC 20, evasion allowed</td>
  </tr> 
  <tr>
   <td>70_t1_swingdead</td>
   <td>Deadly <a href="#swingingblade">Swinging Blade Trap</a></td>
   <td>twice 10d8 damage, reflex save vs DC 30, evasion allowed</td>
  </tr>        
  <tr>
   <td>70_t1_swingepic</td>
   <td>Epic <a href="#swingingblade">Swinging Blade Trap</a></td>
   <td>twice 20d8 damage, reflex save vs DC 35, evasion allowed</td>
  </tr> 
  <tr>
   <td>70_t1_swingminor</td>
   <td>Minor <a href="#swingingblade">Swinging Blade Trap</a></td>
   <td>twice 2d8 damage, reflex save vs DC 16, evasion allowed</td>
  </tr> 
  <tr>
   <td>70_t1_swingstr</td>
   <td>Strong <a href="#swingingblade">Swinging Blade Trap</a></td>
   <td>twice 4d8 damage, reflex save vs DC 25, evasion allowed</td>
  </tr>     
  <tr>
   <td>70_t1_swingweak</td>
   <td>Weak <a href="#swingingblade">Swinging Blade Trap</a></td>
   <td>twice 1d8 damage, reflex save vs DC 10, evasion allowed</td>
  </tr>     
  <tr>
   <td>70_t1_tangepic</td>
   <td>Epic Tangle Trap</td>
   <td>slow for 10 rounds, reflex save vs DC 40 negates</td>
  </tr>     
  <tr>
   <td>70_t1_tangweak</td>
   <td>Weak Tangle Trap</td>
   <td>slow for 2 rounds, reflex save vs DC 10 negates</td>
  </tr>         
  </table>
  <h3>Weak traps</h3>
  <p>Traps from this category are intended for early levels, when player characters doesn't have much hitpoints yet.</p>
  <h3><a name="adjustabletraps">Adjustable traps</a></h3>
  <p>These traps can be adjusted by builder via variables on trap trigger. If you won't set all required variables, the trap might not work as intended; see detailed variables list below (may differ per trap type).<br>
  All variables are of integer type.</p>
  <table border="1" cellpadding="6" cellspacing="1">    
  <tr>
   <td><b>Variable name</b></td>
   <td><b>Description</b></td>
  <tr>
  <tr>
   <td><b>DC</b></td>
   <td>desired DC to avoid damage or paralyse, if unset, save won't be possible!</td>
  </tr>
  <tr>
   <td><b>DamageMin</b></td>
   <td>minimal damage done to target(s), if unset, 1 will be used, if greater than maximum, damage will use minimum and will be fixed</td>
  </tr>
  <tr>
   <td><b>DamageMax</b></td>
   <td>maximal damage done to target(s), if unset, minimum will be used<br>
   note: if both DamageMin and DamageMax won't be set, no damage will be done!</td>
  </tr>
  <tr>
   <td><b>Duration</b></td>
   <td>desired length of the paralysation effect in seconds, if unset paralyse effect will be omitted! <b>Only for Sonic, Frost and Acid Blob</b></td>
  </tr>      
  <tr>
   <td><b>Secondary</b></td>
   <td>special variable <b>only for Electrical</b> adjustable trap that allows to specify how many secondary targets may trap affect</td>
  </tr>     
  <tr>
   <td><b>Drain</b></td>
   <td>special variable <b>only for Negative Energy</b> adjustable trap that allows to specify what will be drained, if unset draining will be omitted<br> values: 1: strength, 2: dexterity, 3: constitution, 4: intelligence, 5: wisdom, 6: charisma, 10: level drain</td>
  </tr>   
  <tr>
   <td><b>DrainNum</b></td>
   <td>special variable <b>only for Negative Energy</b> adjustable trap that allows to specify how many ability points or levels will be drained</td>
  </tr>          
  </table>  
  <h3><a name="swingingblade">Swinging Blade Trap</a></h3> 
  <p>This trap trigger several swinging blades. Character that triggered the trap must roll twice! on reflex saves (evasion allowed) to avoid slashing damage . However the trap visual effect shows always horizontally from west to east, and unfortunately it's not possible to turn it around. See <a href="screenshots/swingingblade.jpg" target="_blank">image</a>.</p>  
 <h2><a name="builds">Character builds and gameplay concerned</a> <span style="font-size: small;margin-top: -5px"><a href="#top">back to top</a></span></h2>
 <p>As far as character builds concerned, there are some changes that player can take in advantage when building. Most new features and balance changes were inspired by DnD 3.0 or 3.5 rules, the same source that Bioware used to followed.</p>
 <p>The most significant feature is that spellcasters now can take epic spells without need to have 21. levels in their spellcasting class, if they meet prerequisities: epic character and spellcraft rank (as the actual ability to be able to cast lvl 9 spells was never checked due to bard/pm and still isn't). This will make them on par with Pale Master who needs just 15levels(+3bard/wiz/sorc) to take epic spells. Every player with community patch 1.70 will be therefore able to take epic spells at lvl 17 for cleric, druid and wizard and at lvl 18 with sorcerer, provided character fulfills all other requirements.</p>
 <p><b>Caution for server admins:</b> This feature works in any NWN server and module, no matter if that server installed Community Patch or not. If, from some reason, you don't want to allow this for your players, you need to get 70_mod_levelup script from this patch, put it into your module's OnLevelUp event and adjust minimal levels back to 21 <i>(see below in new features in toolset section)</i>. Anyone who is getting epic spells before reaching this minimal level will be releveled.</p>
 <p>Except that, there are only minor changes, but still could be useful for building or playing:</p>
 <ul>General changes that affect gameplay:
  <li>Harper scout can take martial weapon proficiency at level with general bonus feat.</li>
  <li>Removed Improved Critical (whip) from Paladin epic bonus feat list.</li> 
  <li>Removed Planar Turning feat from Weapon master epic bonus feat list.</li> 
  <li>Assassin can take Epic skill focus: use magic device as a general epic bonus feat.</li>
  <li>Whip can be dual-wield. <i>(enjoy the Indiana Jones adventures in the new way!)</i></li>
  <li>Casting from scroll qualitifications changed:</li>
  <ul>
   <li>Removed free casting of any scroll for Bard, Wizard and Sorcerer. Now, character can cast spell from scroll for free, only if he got at least one level in any class that is scroll limited to.</li>
   <li>Bard class have been removed from scrolls, which spells aren't in Bard's spell list. <b>Note for builders:</b> this is not retroactive, if you have placed scrolls into shops, they won't change automatically, if you want to take effect from this change, then you must give them into shops again. <i>(unless the shop is in palette and you "spawn" it via script)</i></li>
   <li>Some prestige classes added into scrolls of the spell-like abilities they possess.</li>
   <li>Use Magic Device DC for using a spell scroll has been changed to 7+(3*InnateLevel) in order to allow use scrolls of lesser power to lower level characters. <i>(Was 25+InnateLevel)</i></li>
  </ul>   
  <li class="red">Fixed a bug in the spell penetration calculation where spells cast from special ability tab had their caster level equal to (innate level*2-1) instead of the level assigned by builder.</li>
  <li>Magic immunity is applied before Spell Mantle effect. Means, that for example Fire Arrow spell won't remove spell mantle effect if the target is also protected by globe of invulnerability effect.</li>
  <li>Persistent AOEs now applies spell immunity properly. This fixes exploits with bypassing creature's immunity but also makes globe of invulnerability spell realiable.</li>
  <li>All persistent AOEs will now disappear when their caster becomes invalid (player left game, monster died and disappeared).</li>
  <li>Spell Mantle has no effect against persistent AOE effect. <i>(This is more a side effect from AOE spell immunity workaround, but it does make spell mantle more balanced anyway.)</i></li>
  <li>Mobile AOE spells now works 100% reliable. That is, at least for caster. The aura effects stays with caster all the time even after changing area and the spell's effect never disappear prematurely. Benefits for allies aren't secured; in single player this works perfectly but in some multiplayer modules the aura center often stays still not moving, or jumps once in a while. <br><b>Also there is a secondary effect from this change:</b> the aura visual effect is not visible if you can't see the aura's owner.</li>
  <li>AOE effects created from special abilities such as auras were set to be permanent, supernatural and undispellable. <span class="red">Effects, that are based on the AOE presence are now also undispellable. <i>(For example, it's no longer possible to dispell effects of the silence aura without dispelling the aura first.)</i></span></li>
  <li class="red">Fixed metamagic exploit that allowed to cast spells metamagically enhanced without proper feats.</li>
  <li>Empower metamagic calculation has been united to the OC "empower full result" behavior, which improves namely spells from SoU expansion where only dice result was empowered.</li>
  <li class="red">Excess missiles in <a href="https://web.archive.org/web/20170227224729/http://www.nwnlexicon.com/index.php/DoMissileStorm">missile storm</a>s will be distributed evenly among all targets in area of effect (normally, all excess missiles are directed to the first target, example: 5targets, 9missiles, each target gets hit by 1missile, first target 5, now: each target gets hit by 2missiles except last that takes only 1).</li>
  <li class="red">Added feedback of which spells were <a href="https://web.archive.org/web/20170227224729/http://nwn.wikia.com/wiki/Breach">breach</a>ed <i>(the feedback is not multilanguaged unfortunately, but the value of this feature should prevail this drawback)</i>.</li>
  <li class="red">On "Very difficult" difficulty setting, even spells that normally affect only enemies (such as Isaac's greater missile storm) might target party members.</li> 
  <li>Ioun stone: Dusty Rose's AC has been changed to dodge, thus stacks with items and spells now.</li>
  <li>Attempt to poison weapon may poison the user, giving the Use poison feat real benefit.</li>
  <li>Fear aura will trigger only once per each creature entering <i class="red">(unless Very difficult difficulty)</i>. No more infinite chasing and rolling of 1s.</li>
  <li>Enabled and implemented Shadowblend special ability for Shadow dragons. <i>(Hint: the Continual light spell can effectively dispell Shadowblend effects.)</i></li>
  <li>Enabled and implemented Belker's Smoke Claws special ability.</li>
  <li>Shadow attack strength damage reduced to 1d4 from balance reasons. <i>(and also the fact that the shadow AI is much more effective now)</i></li>
  <li class="red">The 20% spell failure chance from deafness now affect also bardic music: bard song, curse song and every <a href="#instruments">musical instruments</a>.</li>
  <li class="red">Lich lyric and various harphs, lutes, flutes, etc. are now considered as a <a href="#instruments">musical instruments</a> and follow the rules for the bardic music. <i>(cannot be used under silence and also might fail due to the deafness)</i></li>
  <li class="red">Automatic unarmed attack when ran out of throwing weapon stack canceled. Rapid shot, if player had it activated will not be canceled as well. <i>(implemented in x2_mod_def_unaqu script)</i>.</li>
  <li>Verbal component removed from various feats and abilities allowing to use them even under silence effect:</li>
  <ul>
   <li>Arcane Archer arrow feats</li>
   <li>Pale master hand touches</li>
   <li>All pulse abilities</li>
   <li>Various miscelanious spellabilities, mainly used by monsters</li>
  </ul>
  <li>Some wands can now be used by more classes, basically those who have the spell on it in their spellbook too.</li>
  <ul>
   <li>Wand of Summoning - can now be used by cleric, druid and ranger too</li>
   <li>Wand of Arcane Disjunction - can now be used by cleric, druid and paladin too</li>
   <li>Wand of Sleep - can now be used by druid and ranger too</li>
   <li>Wand of Paralysation - can now be used by druid too</li>
   <li>Wand of the Heavens - can now be used by druid too</li>   
  </ul>
  <li>There are several changes that affect default NWN crafting:</li>
  <ul>Item appearance crafting:
   <li class="red">Craft duping disabled.</li>
   <li>Fixed loss of variables on item when coloring the item via dye kit.</li>
   <li class="red">Fixed loss of variables on item in case of crafting failure.</li>    
  </ul>
  <ul>Spell imbue crafting:
   <li>War cry spell level fixed for crafting purposes <i>(unfortunately, makes no longer possible to brew potion of this spell anymore)</i></li>
   <li>Shades, Shadow Conjuration and Vine Mine subspells level fixed for crafting purposes <i>(makes no longer possible to craft these spells into wand/potion)</i></li>
   <li>Added missing War Cry spellscroll, so this spell can be scribed.</li>
   <li>Fixed some spells that couldn't be scribed <i>(for certain classes)</i> before: Aura vs. alignment, Shades, Amplify, Dirge, Undeath to Death, Blade Thirst.</li>
   <li>Various spells now can be brewed into potion - Invisibility purge, Inflict Minor/Light/Moderate/Serious Wounds <i>(something for undeads)</i></li>
	 <li>Various spells now could be brewed into potion - Inflict Critical Wounds, Shadow conjuration, Shades, Greater Shadow Conjuration, Vine Mine <i>(that is, if buider changes maximum spell crafting level)</i></li>
	 <li>Various spells now can't be brewed into potion anymore - Raise dead, Resurrection <i>(although buider changes maximum spell crafting level)</i></li> 
   <li>All spells now could be crafted into wand <i>(that is, if buider changes maximum spell crafting level)</i></li>
   <li class="red">Empty scrolls and potions will stack to 10 pieces.</li>  
   <li class="red">Only 1 piece from stack will be destroyed instead of full stack if the empty scrolls, empty bottles or any material components are stacked.</li>
   <li class="red">Added new feature to specify custom content made potion when brewing (des_crft_spells.2da collumn CustomPotion - value have to be resref).</li>
   <li class="red">Added new feature to specify custom content made wand when crafting wand (des_crft_spells.2da collumn CustomWand - value have to be resref).</li>
   <li class="red">Material components might be required now also for crafting wands and brewing potions, see des_matcomp.2da for details, there are two new collumns, wand_tag and brew_tag.</li>
   <li class="red">Class limitations on crafted wands changed to allow free use only to classes that has the spell imbued in their spellbook <i>(+ the class the spell is cast from)</i>. On the contrary, on easy or very easy game difficulty, both crafted wands and scrolls will be created free of any class limitations.</li>
  </ul>    
 </ul>
 <ul>Individual feat changes that affects gameplay:
  <li class="red">Bard song's skill bonus since level 22+ is now -1 to unite with curse song and to fix the gap between 21 and 22 level song.</li>
  <li class="red">Bards are no longer immune to the curse song of others.</li> 
  <li>Terrifying Rage doesn't work against targets immune to fear or mind affecting spells.</li>
  <li>Imbue Arrow can be fired on the ground.</li>
  <li>Mighty Rage doesn't need targetting anymore.</li>
  <li>Empty body, Rage and Mighty Rage can be reactivated again before old effect wears off.</li>
  <li>Thundering rage adds deafning property into gloves if barbarian doesn't hold any weapon when he use rage.</li>
  <li>Saving throw removed from Shifter's Azer Fire Stream ability <i>(is a ray and those usually doesn't grant save)</i>.</li>
  <li>Empower/maximized metamagic allowed for Cloud of Bewilderment spell.</li>
  <li>Air elemental wind pulse can blown out cloud-like AOEs, just like Gust of wind spell does.</li>
 </ul>
 <ul>Individual spell changes that affects gameplay:
  <li class="red">Ball lightning spell target area changed to the single target as per spell's description (the spell is still "missile storm" that creates multiple missiles and each still inflict only 1d6 damage).</li> 
  <li>Regenerate spell doesn't stack with itself anymore.</li>
  <li>Black blade of disaster's concentration check now take into consideration also these actions: recover trap, examine trap, set trap, open lock, lock.</li>
  <li>Epic spell Hellball won't affect caster at all if cast on self.</li>  
  <li>Bombardment spell damage cap have been increased to 20d8.</li>
  <li>Sunbeam does full damage to all oozes and plant creatures as if they were undead. <i>(technically since there isn't plant race in vanilla NWN, this is done via subrace field which should contain "plant" (not case-sensitive))</i></li>
  <li>Vine mine subspells innate level corrected to 5 <i>(thus +4DC)</i>.</li>
  <li>Gust of wind spell can now also blown out the area of effect of the Stonehold spell.</li>
  <li>Balagarn's Iron Horn school changed to transmutation.</li>  
  <li>Magic Vestment spell is now able to target shield. To do it, targetted character must strip his armor first.</li>
  <li>Initial damage allowed for Melf's Acid Arrow and Infestation of Maggots spells.</li>
 </ul>
 <p>The monster AI was significally improved, fixed many bugs along with the most stupid behavior. Creatures might also use talents they couldn't before. But there are also changes that makes life of an adventurers easier.</p>
 <ul>AI changes:
 	<li>At very high difficulty, creatures are using auras instantly. <span class="red">Also, creatures with high AI will be able to activate any auras instantly regardless of difficulty setting.</span></li>
 	<li>Creatures with high AI will try to ignore or immediately dispell the Black Blade of Disaster.</li>
  <li>Fixed bug that disallowed a creature or henchman to use any other combat feat then disarm on targets of good alignment.</li>
  <li>Confused creatures will now attack only those they can see or hear. <i>(Previously attacked nearest creature without perception consideration.)</i></li>
  <li>Creatures in any disabled state (confused, frightened, turned) won't attack when spell is cast on them anymore.</li>
  <li>Creatures will spam knockdown feat a little less often.</li>
  <li>Creatures will never ignore the Greature Sanctuary effect anymore. This fixes the <i>"inv+GS"</i> issue, however only for a monsters. Player characters will still be able to attack you.</li>
	<li>Creatures now won't waste smites on wrong (neutral) targets.</li>	
	<li>Creatures now won't use rapid shot feat with melee weapon (which resulted in doing nothing).</li>  
	<li class="red">Creatures won't use flurry of blows with ranged weapon anymore (which resulted in doing nothing).</li>
  <li class="red">Creatures won't waste quivering palm on wrong (immune) enemies anymore.</li>
  <li>Spellcasters won't attack melee earlier than they cast everything that works.</li>
  <li>Creatures inside (multiple) AOEs won't stop attacking. Also they won't teleport to the caster once he leave the current area.</li>   
  <li>Fixed turning undeads used by NPCs on vermins.</li>
	<li>NPCs won't try to turn undead anymore, if their turning level (was character level) is not high enough.</li>  
  <li>Invisible casters switch back to offensive if their target suddenly can seen them.</li>
	<li>Casters with HIPS won't attack melee anymore but rather HIPS-cast.</li>
	<li>Creatures won't waste full-heal talents if they are not wounded badly.</li>
	<li>Undead creatures are now able to use Harm and lesser inflict spells, and even custom potions with these spells to heal themselves.</li>
	<li>Creatures won't move towards target when casting Time Stop spell.</li>
	<li>Creatures won't cast true seeing/see invisible/clairvoyance spells if they have theirs effects already on them, <span class="red">or if they have true seeing on the skin or if they possess the blindsight ability</span>.</li>	
  <li class="red">Creatures won't cast haste on targets hasted already <i>(still doesn't check haste items due to the efficiency constraints)</i>.</li>
	<li class="red">Creatures won't use petrify talents on already petried target.</li>
	<li class="red">Creatures won't waste control undead or undeath to death spells on living targets.</li>
	<li>Creatures will use level draining bolt or pulse despite their target is drained already.</li>
	<li>Creatures will ignore AOEs they are inside, if they are immune to that AOEs effects.</li>
	<li>Creatures will substitute a negative energy talent with best healing talent if they are dealing with undead opponents.</li>		
  <li class="red">Arcane casters with Automatic still spell III will be able to cast spells with armor/shield normally.</li>
  <li class="red">Improved "heard behavior" - when creature can hear an attacker and do not have any revealing talents, she will try to use at least defensive talents, if has any.</li>
  <li class="red">Added "vanish behavior" - when target vanish to the creature, creature will try to reveal his position using spells or at least use defensive talents, if has any.</li>  
  <li class="red">Fixed bug, that caused associates to cast one spell over and over unable to finish it as long as their master was attacking.</li>
  <li class="red">Bards and sorcerers will cast more randomly (as if they had X2_SPELL_RANDOM variable set to TRUE, setting the variable X2_SPELL_RANDOM to -1 disables this feature).</li>    
  <li class="red">Improved AI for bard creatures:</li>
  <ul>
   <li class="red">Bards will be able to use Curse song.</li>
   <li class="red">Fixed silence/deaf issue that led bards to endless bard song loop or being stucked.</li>  
   <li class="red">Increased chance that bards will go into normal attack instead of casting spells.</li>
   <li class="red">Bards with spell failure over 30% won't try to cast spells anymore <i>(unless having Autostill spell II+)</i>.</li>
  </ul>
  <li>Inventory and equipment code fixes and improvements:</li>
  <ul>
   <li>Fixed bug that caused creatures to unequip and ignore throwing weapons.</li>
   <li class="red">Better ranged weapons handling, ordinary creatures will always try to equip ranged weapon at ranged distance <i>(this further improves fix above to allow throwing weapons - with this improvement, creature using throwing weapons will equip new stack after ran out)</i>.</li>
   <li class="red">Fixed not equipping ranged weapon when explicitly told to from conversation.</li>
   <li class="red">Henchmans won't try to equip unidentified items.</li>
   <li class="red">Small creatures won't try to equip tower shield.</li>
   <li class="red">Unarmed monks won't try to equip inappropriate melee weapons or shield.</li>
   <li class="red">Rangers will be able to dual wield without need for ambidex/two weapon fighting.</li>
   <li class="red">Creatures with shield equipped won't try to equip other shields from inventory.</li>
  </ul>
  <li class="red">Added variable 70_ALLOW_RAGE/int/1 allowing barbarian creatures to use Rage and Mighty rage feats. <i>(It's not automatically on because many default barbarian monsters possess creature rage variant as compensation already.)</i></li>
  <li class="red">Polymorphing was disabled completely because of numerous bugs and behavior issues.</li>
  <li class="red">Added variable 70_ALLOW_SHAPECHANGE/int/1 allowing creatures to polymorph intelligently.</li>
  <li class="red">Fixed reactivating Rage ability in combat.</li>
  <li class="red">Fixed AI stuck issue with Animate Dead, Summon Undead and Summon Greater Undead feats.</li>
  <li class="red">Assassins with death attack and Blackguards's with BG's sneak will try to flank as well.</li>
  <li class="red">Creatures will use smite evil, smite good and stunning fist regardless of their "attack" rating (they didn't used these talents against high AC targets at all).</li>
  <li class="red">Fixed bug that prevented the monsters to stop attacking dying player.</li>
  <li>and many minor improvements in AI (removed some immunity checks so creatures will try certain spells even when target is immune, better code to handle HP limit in Power Word: Death spell, creatures with true seeing itemproperty may cast darkness, and mainly improved efficiency)</li>
 </ul>
 <div class="red"><h3>Poison and disease engine improvements</h3>
 <p>Community Patch introduces a complete overhaul of the NWN poison and disease "engines". This is of course unrecognizeable by the end user but it allows plenty of a new things to do with poisons and diseases such as poison stacking or to actually recognize that effect was applied by a poison/disease which can be processed by a builder.</p>
 <p>Every poison and disease is now driven by a special script (script name can be found in poison.2da and diasease.2da) and a new script libraries "70_inc_poison" and "70_inc_disease". A new poison/disease must follow this new convention and you have to create a new scripts for them. (Really have to, it won't work anymore without a script, but you can revert this engine with a poison.2da/disease.2da file from a patch 1.69 where you don't need to make scripts.)</p>
 <ul>List of features:
  <li>All poisons and magical diseases and their effects were set to be extraordinary. <i>(Thus is no longer possible to remove them with dispel magic spells)</i></li>
  <li>On D&D; Rules difficulty or higher, Remove disease will not remove poison effects and an antidote potion/Neutralize spell with not remove disease effects. Both spells will still cure the ability damage effects from other sources (such as negative energy burst) though.</li>   
  <li>With a module switch integer variable 71_ALLOW_POISON_STACKING set to TRUE or at Very Difficult difficulty, poisons can stack.</li>
  <li>Pit Fiend Ichor poison effect (death) ignores death magic immunity.</li>
 </ul>
 <p><b>Note about poison stacking:</b> Technically speaking, the poison icon and a green color at HP bar is removed and thus won't block other poisons to affect target again. However, the "OnHit: Poison (DC/ability)" itemproperty <u>doesn't work</u> with this new engine. If you want the poisons from monster's onhits to stack, you have to replace all of these properties with the OnMonsterHit variant.<p>
 <p><b>ISSUE WARNING:</b> The new poison system is not 100% backwards compatible. In a case that you would allowed poison stacking but had old script for neutralize poison spell, the poison effects won't be properly removed from veins and the secondary poison effect will affect character anyway!</p></div>
 <h2><a name="toolset">New features in toolset</a> <span style="font-size: small;margin-top: -5px"><a href="#top">back to top</a></span></h2>
 <p>Community Patch adds many new features especially for builders. Builders may now adjust cost and minimal level requirement for any of their items, add more spells into their potions and wands etc. These changes are described in <a href="#itemprops">Expanded Item Properties full notes</a>.</p>
 <p>Builder may also disable any standard base class via scripting. That may be usefull, if you want for example limit some class combinations or force max dual-class, etc. To do it, you must set a variable on player character via script (probably in OnEnter and OnLevelUp). All variables are of integer type, value 1 disables the class, value 0 will reenables it again.</p>
 <ul>Variables names:
  <li>70_AllowBarbarian - will disable barbarian class</li>
  <li>70_AllowBard - will disable bard class</li>
  <li>70_AllowCleric - will disable cleric class</li>
  <li>70_AllowDruid - will disable druid class</li>
  <li>70_AllowFighter - will disable fighter class</li>
  <li>70_AllowMonk - will disable monk class</li>
  <li>70_AllowPaladin - will disable paladin class</li>
  <li>70_AllowRanger - will disable ranger class</li>
  <li>70_AllowRogue - will disable rogue class</li>
  <li>70_AllowSorcerer - will disable sorcerer class</li>
  <li>70_AllowWizard - will disable wizard class</li>  
 </ul>
 <p class="red">Each prestige class now have maximum level set to 60, in order to allow set more than 40 via creature wizard. Keep in mind, that not every abilities scales after lvl 40 though.</p>
 <p>There are new scripts, that might builders find usefull.</p>
 <ul>Special scripts that comes with the Community Patch:
  <li><b>70_mod_levelup</b> - a script supposed to be used in module's OnPlayerLevelUp event. Its primary purpose is to control whether the epic spells wasn't taken earlier than intented due to the exploit in game. The default minimum levels are 15 for pale master, 17 for wizard, druid and cleric and 18 for sorcerrer. These levels might be adjusted by builder in script and effectively disable this 1.70 feature if the builder feel its not appropriate into his module environment. Additionally, it delevel and force to redo levelling up process in case of:</li>
  <ul>
   <li>Player levels up while polymorphed.</li>
   <li>Player takes epic spells earlier than supposed by the CP or builder's intention.</li>
   <li class="red">Player takes Bane of enemies or Epic fiend feats earlier than supposed to.</li>
  </ul>
  <li><b>70_c2_aihigh9</b> - a script supposed to be used in creature's OnSpawn event. It will set the creature's AI level to value of AI_LEVEL_HIGH and enable few high-ai related features coming with this patch.</li>  
 </ul>
 <p>There are also new module switches added into <u><a href="https://web.archive.org/web/20170227224729/http://www.nwnlexicon.com/index.php/X2_inc_switches">x2_inc_switches</a></u> include file. You may set them via bioware script function SetModuleSwitch or manually by putting desired variable onto module. All variables are of integer type.</p>
 <p class="red">Setting an integer variable called "<b>71_SOU_EMPOWER_SPELL_BEHAVIOR</b>" to <b>1</b> on module object enforce the SoU Empower Spell behavior which is empowers only dice results. This behavior effectively fixes the issue when the empower surpases maximize in the damage output even when the maximize is more expensive to cast.</p>
 <p class="red">Setting an integer variable called "<b>71_UNLIMITED_SUMMONING</b>" to <b>1</b> on module object enables to summon and control multiple unlimited number of summoned creatures at the same time. Values higher than 1 instead raises the limit, so if you want to allow max two summons at the same time, apply this switch with value of 2.</p>
 <p class="red">Setting an integer variable called "<b>71_RESTRICT_MUSICAL_INSTRUMENTS</b>" on module object will restrict usage of the <a href="#instruments">musical instruments</a> according to the switch value:</p>
 <ol class="red">Possible values:
  <li>restricted to perform skill, DC of this task is 7+3*SpellLevel</li>
  <li>restricted to bard song uses, same way as <a href="https://web.archive.org/web/20170227224729/http://nwn.wikia.com/wiki/Lyrics_of_the_lich">Lich lyric</a> works.</li>  
 </ol>
 <p class="red">Setting an integer variable called "<b>71_POLYMORPH_STACK_ABILITY_BONUSES</b>" to <b>1</b> on module object enable to stack ability bonuses from multiple items merged on skin when polymorhing. By default only highest bonus applies.</p>
 <p class="red">Setting an integer variable called "<b>71_POLYMORPH_MERGE_ARMS</b>" to <b>1</b> on module object enable to merge bracers or gloves within "items" merge category. Note, that bonuses are transferred onto skin, so only defensive item properties are actually merged.</p>
 <p class="red">Setting an integer variable called "<b>71_PALEMASTER_ADDS_CASTER_LEVEL</b>" to <b>1</b> on module object will apply Pale master levels into the caster level calculation. This feature of course works only for arcane spells cast from a wizard, sorcerrer or bard class. It won't work for spells cast from items, special abilities or from feats.<br>
 Note, that the bonus is not +1 per level as one might thought. The bonus is +1 for each odd level as thats the way how PM's caster level works for wizard spell slots. However, this feature is taking into consideration the 2da settings in classes.2da, so if the builder changes the <a href="https://web.archive.org/web/20170227224729/http://nwn.wikia.com/wiki/Classes.2da#Column_notes">ArcSpellLvlMod</a> for PM the formula will respect this and allows to add caster level for each PM level.</p>
 <p class="red">Setting an integer variable called "<b>71_SHORTENED_DURATION_OF_DISABLE_EFFECTS</b>" on module object changes the behavior of the <a href="https://web.archive.org/web/20170227224729/http://www.nwnlexicon.com/index.php/GetScaledDuration">GetScaledDuration</a> function and allow to shorten duration to 3 rounds (at "D&D; rules" and "Very difficult" difficulty) considering who is target and who is caster. This feature works for most disable effects (fear, paralysis, stun, charm, daze, dominate, knockdown and entangle) and only if the duration of the ability they come from is based on hit dice or caster level. Abilities with exact duration specified, such as "1d6", are not affected.</p> 
 <ol class="red">Possible values:
  <li>apply only when caster isn't PC and target is PC or his associate</li>
  <li>apply regardless of who is caster but only when target is PC or his associate</li>
  <li>apply regardless of who is caster and who target</li>  
 </ol>
 <p class="red">Setting an integer variable called "<b>71_ALLOW_POISON_STACKING</b>" to <b>1</b> on module object enable poisons to stack. By default, character cannot be poisoned anymore if is poisoned already. With this switch, the poison effect itself is removed from character with also the green HP bar indicating that player is poisoned, but the poison is still running on background, unless cured. Standard methods for removing poison <i><b>except healer's kit</b></i> will still work.</p> 
 <p class="red">Setting an integer variable called "<b>71_ALLOW_BOOST_GLOVES</b>" to <b>1</b> on module object will allow weapon-boost spells <i>(like flame weapon)</i> to target and enhance gloves <i>(but not bracers!)</i> like any other weapon.</p> 
 <p>Setting an integer variable called "<b>70_AOE_HEARTBEAT_WORKAROUND</b>" to <b>1</b> on module object enable the heartbeat workaround if AOE spells in your module doesn't work properly.</p>
 <p>Setting an integer variable called "<b>70_AOE_IGNORE_SPELL_RESISTANCE</b>" to <b>1</b> on module object will disable spell resistance and spell immunity to work for all AOE spells.</p>
 <p>Setting an integer variable called "<b>70_RESISTSPELL_SPELLMANTLE_GOES_FIRST</b>" to <b>1</b> on module object will restore 1.69 spell mantle behavior, where spell mantle takes precedence over spell immunity.</p> 
 <p>Setting an integer variable called "<b>70_OVERFILLED_STORES_ISSUE_FIX</b>" on module object will apply and workaround to fix the lag issue when there are too many items sold to the store. The value of this variable controlls how many items sold there can be in store at one time. After this value is reached everytime someone sell new item, the oldest item will disappear. Recommended value is <b>100</b>.<br>
 <i>Note: in order this feature could work, the module must use the "x2_mod_def_unaqu" default script (and its 1.70 version!) in its OnUnAcquire event, either directly or from other script via ExecuteScript command.</i></p> 
 <p>These variables/switches applies for a creatures. Set them either manually on the creature you need or via her OnSpawn script.</p>
 <p>Setting an integer variable called "<b>IMMUNITY_DROWN</b>" to <b>1</b> will grant the immunity to any drowning spell/ability.</p>
 <p>Setting an integer variable called "<b>IMMUNITY_PETRIFICATION</b>" to <b>1</b> will grant the immunity to any petrification spell/ability.</p> 
 <p>Setting an integer variable called "<b>IMMUNITY_PLANAR_RIFT</b>" to <b>1</b> will grant total immunity to Planar Rift, the Black Blade of Disaster's deadly onhit. <i>(the standard immunity via itemproperty would not work in all cases, thats the reason for this workaround)</i></p>
 <p>Setting an integer variable called "<b>FLYING</b>" to <b>1</b> will make sure the creature will be recognized by certains spells/abilities as flying. Flying creatures are immune to the ground effects such as grease, spike growth or caltrops.</p>
 <p>Setting an integer variable called "<b>MINDLESS</b>" to <b>1</b> will make sure the creature will be recognized by certains spells/abilities as mindless. This is so far used only in Tasha's hideous laughter spell to grant an immunity.</p> 
 <p class="red">Setting an integer variable called "<b>SIGHTLESS</b>" to <b>1</b> will make sure the creature will be recognized by certains spells/abilities as sightless. Sighless creatures are immune to the gaze effects and any other sight affecting abilities such as flare spell. Note that all oozes are sightless by default, so there is no need to set this variable for creatures with ooze racial type.</p> 
 <p class="red">Setting an integer variable called "<b>LIGHTVULNERABLE</b>" to <b>1</b> will make sure the creature will be recognized by certains spells/abilities as vulnerable to light. Light vulnerable creatures takes twice as much damage from light spells such as sunbeam and sunburst.</p>
 <p class="red">Setting an integer variable called "<b>70_ALLOW_RAGE</b>" to <b>1</b> will allow the creature to use the normal barbarian rage or mighty rage feats.</p>  
 <p class="red">Setting an integer variable called "<b>70_ALLOW_SHAPECHANGE</b>" to <b>1</b> will allow the creature to use any of the druid or shifter shapechange feats.</p>
 <h3><a name="spellfeatures">New Spell Engine features for builders:</a></h3>
 <p>The new spell engine allows builder to override some spell related informations like caster level or metamagic. Note however, that none of this will work for any spells in your module/override/haks that have not been upgraded onto new spell engine. If you want to use any of these features in a spell which script is in your module, you will have to rewrite that script with the use of the new spell engine.</p>
 <p>You can adjust caster level, metamagic and DC of the spell cast, but differently for spells cast the regular way, spells cast from item and for spells cast from other sources like monster's special abilities. This is done using a variable on player character/creature/item/other object. You can type and add it manually (except PC of course) or via custom script. However, by default is it not possible to tell the new spell engine that the override DC should be applied only to certain spell, so it does applies to all spells until the variable value is deleted. This issue could be workarounded via custom scripting <i>(for example in module SpellHook)</i>, but unfortunately there is no new feature to make this task easier.</p>
 <h4>For spells cast the regular way:</h4>
 <p>A regular way is when the spell is cast from a class. All player character's <i>(not DM!)</i> spells and feats are cast this way. Also any spell cast by monster from Spell list is.</p> 
 <p>Setting an integer variable called "<b>SPELL_CASTER_LEVEL_OVERRIDE</b>" on a creature or PC will override caster level for any spell cast the regular way, to specified value. ANY positive value is possible! However overriden caster level does not unfortunately applies for dispell magic check and penetrate spell resistance of monks of level 12 and higher. In both cases, the spell still counts with original caster level computed from class level the spell cast.</p>
 <p class="red">Setting an integer variable called "<b>SPELL_CASTER_LEVEL_MODIFIER</b>" on a creature or PC will modify the caster level for any spell cast the regular way, by specified value. This feature is great if you want to have various spells and special abilities at different caster levels, as override feature will set the same level for all of them. All caveats noted for overriding caster level before applies there as well.</p>
 <p>Setting an integer variable called "<b>SPELL_METAMAGIC_OVERRIDE</b>" on a creature or PC will override metamagic for any spell cast the regular way, to specified value. Values matches NWScript constants.</p>
 <ul>Possible values:
  <li>1: every spell cast will be empowered <i>(only if the spell allows it)</i></li>
  <li>2: every spell cast will be extended <i>(if allowed)</i></li> 
  <li>4: every spell cast will be maximized <i>(if allowed)</i></li>
  <li>its possible to use other values like 16 (METAMAGIC_SILENT) but since these metamagic applies before spell is cast, it won't have much of an effect by default.</li>
 </ul>
 <p>Setting an integer variable called "<b>SPELL_DC_OVERRIDE</b>" on a creature or PC will override saving throw DC for any spell cast the regular way, to specified value. <b>Any</b> positive value is possible.</p> 
 <p class="red">Setting an integer variable called "<b>SPELL_DC_MODIFIER</b>" on a creature or PC will modify the saving throw DC for any spell cast the regular way, by specified value. Both positive and negatice values are possible.</p>
 <h4>For spells cast not the regular way:</h4>
 <p>This applies not only when the spells is cast by a creature from its special abilities but also if a caster is Dungeon Master's character or whenever the spell is cast via script using value of bCheat = TRUE such as projectile traps.</p> 
 <p>Setting an integer variable called "<b>SPECIAL_ABILITY_CASTER_LEVEL_OVERRIDE</b>" on a creature or any other object will override caster level for any spell cast the non-regular way, to specified value. This will mainly allow to get around the toolset limit of caster level 15 for special abilites. All caveats noted for overriding caster level before applies there as well.</p>
 <p class="red">Setting an integer variable called "<b>SPECIAL_ABILITY_CASTER_LEVEL_MODIFIER</b>" on a creature or any other object will modify the caster level for any spell cast the non-regular way, by specified value. All caveats noted for overriding caster level before applies there as well.</p>  
 <p>Setting an integer variable called "<b>SPECIAL_ABILITY_METAMAGIC_OVERRIDE</b>" on a creature or any other object will override metamagic for any spell cast the non-regular way, to specified value. Values are the same as for regular spells above.</p>
 <p>Setting an integer variable called "<b>SPECIAL_ABILITY_DC_OVERRIDE</b>" on a creature or any other object will override saving throw DC for any spell cast the non-regular way, to specified value. Again, <b>any</b> positive value is possible.</p>
 <p class="red">Setting an integer variable called "<b>SPECIAL_ABILITY_DC_MODIFIER</b>" on a creature or any other object will modify the saving throw DC for any spell cast the non-regular way, by specified value. Both positive and negatice values are possible.</p>
 <h4>For spells cast from an items:</h4>
 <p>This applies when the spell was cast from certain item. That includes any type of item, bard's flute, potion, scroll, anything. The variable and its value must be placed on item in question, but as said before, if there is more than one spell on item, the overriden values will applies for each of them unless workarounded via custom content script.</p>
 <p>Setting an integer variable called "<b>ITEM_CASTER_LEVEL_OVERRIDE</b>" on an item will override caster level for any spell cast from this item to specified value. All caveats noted for overriding caster level before applies there as well.</p>
 <p class="red">Setting an integer variable called "<b>ITEM_CASTER_LEVEL_MODIFIER</b>" on an item will modify the caster level for any spell cast from this item, by specified value. All caveats noted for overriding caster level before applies there as well.</p>
 <p>Setting an integer variable called "<b>ITEM_METAMAGIC_OVERRIDE</b>" on an item will override metamagic for any spell cast from this item, to specified value. Values are the same as for regular spells above.</p>  
 <p>Setting an integer variable called "<b>ITEM_DC_OVERRIDE</b>" on an item will override saving throw DC for any spell cast from this item to specified value. Again, <b>any</b> positive value is possible.</p>
 <p class="red">Setting an integer variable called "<b>ITEM_DC_MODIFIER</b>" on an item will modify the saving throw DC for any spell cast from this item, by specified value. Both positive and negatice values are possible.</p>
 <p class="red">Setting an integer variable called "<b>ITEM_SPELL_OVERRIDE</b>" on an item to the value of any spell ID (see <a href="https://web.archive.org/web/20170227224729/http://nwn.wikia.com/wiki/Spells.2da_(contents)">spells.2da</a>, -1 for acid fog) will override an actual spell that is cast from that item. For example: ITEM_SPELL_OVERRIDE = 4 will trigger a Bestow curse spell instead of healing spell when an item <i>(potion maybe)</i> is used <i>(drank)</i>.</p>  
 <h4>Additional spell based features:</h4>
 <p>Setting an integer variable called "<b>DISABLE_RESIST_SPELL_CHECK</b>" to <b>1</b> on creature/item/any object will disable the SpellResist check which means that any spell cast will ignore spell immunity, spell mantle and spell resistance. This is especially usefull for projectile traps.</p>
 <h3 class="red"><a name="instruments">Musical instruments</a></h3>
 <p class="red">Musical instruments are miscelanious items with an icon of some musical instrument. These often allows bard, and anyone with enough UMD skill, to cast some spell or special abilities. CP enhances these items and allows to set special rules to use them. Musical instruments in CP plays a sound when player uses them and are also a subject to the silence and deafness effects; silence prevent from using them at all, deafness adds a 20% chance to failure.</p>
 <p class="red">They might also additionally require perform skill check (DC is 7+3*SpellLevel by default) or might decrease bard song feat uses. This is dependant on the module settings which can be changed by the module builder in toolset, or by a player via <a href="#widget">PC Widget tool</a>. These restrictions are not enabled by default though.</p>
 <p class="red">To mark a custom item as a musical instrument, builder must place an integer variable called "<b>MUSICAL_INSTRUMENT</b>" to 1 on this item.</p>
 <p class="red">This is everything required to enable CP features, however you can also set up custom sound which will play after use (this is the usual bard song sound by default).</p>
 <p class="red">To set a sound played by musical instrument, builder must place a string variable called "<b>MUSICAL_INSTRUMENT_SOUND</b>" to the sound resref on this item.</p>
 <ul class="red">Recommended values are:
  <li>as_cv_flute1</li>
  <li>as_cv_flute2</li>
  <li>as_cv_lute1</li>
  <li>as_cv_lute1b</li>
  <li>as_fanfare_horn</li>
  <li>sdr_bardsong (standard bard song sound, default value)</li>  
 </ul>
 <p class="red">CP allows also to override perform skill DC if you plan to use this restriction.</p>
 <p class="red">To override default perform DC, builder must place an integer variable "<b>MUSICAL_INSTRUMENT_DC</b>" with value of the desired DC, on this item.</p>
 <p class="red">However, while normally the DC might be different for each spell on musical instrument item, with this variable set, DC will be the same for all spells the musical instrument have.</p>
 <h3>Other special features:</h3>
 <p>And one more speciality. With community patch, creatures possessed by DM also fire their death script. This fixes the custom experience rewards and also creatures like Stinking beetle or Balor with special effect when they die. This works for all default creatures, however if you have any custom creature or even your own Balor/Stinking beetle copied from default before patch 1.70, it won't work. To ensure it will, you must set special variable onto any of such creature.</p>
 <p>Setting a string variable called "<b>DEATH_SCRIPT</b>" with value of the OnDeath script name on the creature will ensure that this creature, if possessed by DM will run specified script if she die.</p>
 <p>To know the name of current death script of the creature, go into creature's properties, Scripts tab and copy the name of the script in OnDeath line.</p>
 <h2><a name="itemprops">Itemproperties Expanded full notes</a> <span style="font-size: small;margin-top: -5px"><a href="#top">back to top</a></span></h2>
 <p>The Community patch's itemproperties contains several concepts from various authors. Main part were took from Ben Harrison's Expanded Itempropertis hak, but only those changes that doesn't require hak pack. Second is a "classic" item cost decrease option, which idea is from the oldest times due to fact that Item Level Restriction is completely unbalanced and builders always wanted to adjust it. Now they can do that very simply via new itemproperty (present solution is a new unique solution, based on various old techniques found on vault).</p>   
 <ul>itempropdef.2da
  <li>Ability bonuses are now shown as "Ability bonus" intead of "Enhancement bonus:" <i>(client-side, only those who have community patch will see this.)</i></li>
  <li>Saving throw bonus now refer to <b>iprp_bonuscost.2da</b> in order to limit it to +12 <i>(higher values doesn't work)</i>. This is not retroactive, it won't change old items in any way.</li>   
  <li>New itemproperty called Item Cost Parameter that allows a builder to reduce or increase the cost of his item in order to change minimum item level. Refers to <b>iprp_value.2da</b> and <b>iprp_valuecost.2da</b></li>
  <li class="red">Unused and nonfunctional itemproperty Wounding enabled and implemented as a negative regeneration <i>(this will however work only in modules using default and unmodified equip script x2_def_mod_equ, or in modules updated to work with community patch)</i>.</li>  
 </ul>
 <p>When you choose <b>Item Cost Parameter</b> in toolset, there are six choices A,B,C,D,E and F. This is a base cost value that is multiplied with the parameter you must choose. A starts at 10, B is 100 and so on to F which is worth a milion. Once choosen, you can specify the multiplier: There are values from -1 to -10 which will decrease the cost and below this are positive values 1 to 10 that increases the cost. Due to the item cost formula, the actual costs doesn't always exactly match X*multiplier, but its quite close to it and it fulfills the purpose. The property stacks with itself, so there is actually no limit in the maximum value adjusted. This itemproperty is <b>invisible</b>, meaning that it doesn't appear on the item properties list in game!</p>
 <ul>itemprops.2da
  <li>Enhancement Bonus, Extra Melee Damage type, Keen, <span class="red">Holy avenger</span>, No Damage, Vampiric Regeneration, On-hit, and Attack Bonus vs. Alignment/Class/Race properties enabled for the Gauntlet <i>(gloves/unarmed)</i> base item</li>
  <li>Enhancement Bonus, Damage Bonus, Keen, No Damage, and Attack and Damage penalty properties enabled for ranged weapons</li>
  <li>Keen and <span class="red">Regeneration</span> property enabled for thrown weapons</li>
  <li>Keen and Holy avenger properties enabled for the Magic Staff base item</li>  
  <li>Base Item Weight Reduction and Weight Increase properties enabled for all items</li>
  <li>Turn Resistance property enabled for player equippable items</li>
  <li>Properties enabled for the Gem base item and Torch base item</li>
  <li class="red">Cast spell property enabled on containers</li>
  <li class="red">Regeneration property enabled on creature weapons</li>
 </ul>
 <b>Note:</b> Turn resistance works since this Patch for a player characters, but technically this is done inside Turn Undead ability as a bonus from items - it doesn't work with turn resistance increase/decrease effect due to the technical limitations.
 <p><b>Stacking note:</b> keep in mind that ranged weapon properties counts together with ammunition properties meaning that if you add an enhancement bonus or elemental damage on bow it won't stack with arrows +X (which grants +X piercing damage) or elemental arrows of the same type. See <a href="https://web.archive.org/web/20170227224729/http://nwn.wikia.com/wiki/Enhancement_bonus">NWN Wiki</a> for more detailed info.</p>
 <ul>Other itemproperties
  <li>Added "None" into Visual Effect property - this unfortunately doesn't work in toolset. But does ingame. <i>(iprp_visualfx.2da)</i></li>
  <li>Also weapon visual effects are now compatible with NWNCX new weapon visuals feature.</li>
  <li>Added new values of 1,2,3,4,250,500 and 750 lbs, into Weight Increase itemproperty. <i>(iprp_weightinc.2da)</i></li>    
  <li>Negative values cost balanced. <i>(iprp_neg10cost.2da)</i></li>
  <li>Added Blade Barrier and Destruction into "Immunity: Specific spell". <b>Note:</b> this is intended for NPCs only. Players without Community Patch would see "Imunity: Specific spell: Bad Strref". <i>(iprp_spellcost.2da)</i></li>
  <li>Inflict spells family fixed to appear on "On Hit Cast Spell" item property. Again this is rather for NPCs only, not just because players without Community Patch would see Bad Strref again, but also for balance reasons. <i>(iprp_onhitspell.2da)</i></li>
  <li>All non-epic spells can be placed into wand in toolset now. <i>(iprp_spells.2da)</i></li>
  <li>Several spells can be added into potion in toolset now. (Harm, Improved Invisibility, Regenerate, Monstrous Regenerate, Legend Lore, War Cry, Aura of Vitality, Energy Buffer, Protection from Alignment, Magic Circle vs Alignment, Aura vs Alignment, Shadow Conjuration, Nature's Balance, Mass Haste, Invisiblity Purge, Invisibility Sphere, Healing Circle, Dirge, Undeath Eternal Foe, Stone to Flesh, Battletide, Mestil's Acid Sheat, Stone Bones, Etherealness) <i>(iprp_spells.2da)</i></li>
  <li>Ioun stone "spells" cannot be placed into potion/wand anymore. <i>(iprp_spells.2da)</i></li>
  <li>Mestil's Acid Sheat spell cost corrected to match other fifth lvl spells and in order to make scroll of this spell under ILR no longer usable by a lvl 2 characters.</li>
  <li>Barkskin spell level on items changed from 6 to 7 and from 12 to 13 in order to allow make custom potions of +4 and +5 AC. <i>(iprp_spells.2da)</i></li> 
  <li class="red">Added trap, spell, law, chaos, good and evil subtypes into saving throw itemproperty <i>(it's however important to realize that no vanilla spell/ability uses alignment based saving throw so this is should be used in conjuction with custom content)</i>.</li>
 </ul>
 <h2><a name="scripts">Scripting changes and improvements</a> <span style="font-size: small;margin-top: -5px"><a href="#top">back to top</a></span></h2>
 <p>Community patch also adds many scripting-related features such as new constants, functions or includes. Some of the default functions' descriptions has been updated to remove incorrect statements.</p> 
 <ul>New NWScript constants
  <li>SAVING_THROW_TYPE_PARALYSE - to be used inside functions dealing with saving throws</li>
  <li class="red">ATTACK_BONUS_UNARMED - these constants works for EffectAttackIncrease/Decrease functions and allows to make an attack bonus working only when fightning with creature weapon or unarmed</li>
  <li class="red">ATTACK_BONUS_CWEAPON1</li>
  <li class="red">ATTACK_BONUS_CWEAPON2</li>
  <li class="red">ATTACK_BONUS_CWEAPON3</li>
  <li class="red">IP_CONST_SAVEVS_TRAPS - these constants works for ItemPropertyBonus/ReducedSavingThrowVsX functions</li>
  <li class="red">IP_CONST_SAVEVS_SPELLS</li>
  <li class="red">IP_CONST_SAVEVS_LAW</li>
  <li class="red">IP_CONST_SAVEVS_CHAOS</li>
  <li class="red">IP_CONST_SAVEVS_GOOD</li>
  <li class="red">IP_CONST_SAVEVS_EVIL</li>  
 </ul>
 <ul class="red">Other changes:
  <li>Constant for OBJECT_TYPE_ALL changed to 0.</li>
  <li>Constants for Devil Chills and Demon Fever diseases corrected (swapped).</li>
  <li>Note for SetBaseAttackBonus function corrected to inform it does works for PC actually.</li>
  <li>Fixed declaration/implementation inconsistencies in few default includes (x0_i0_anim, x2_inc_spellhook, x2_inc_restsys).</li>
  <li>WalkWayPoints (x0_i0_walkway): added new flag NW_WALK_FLAG_LOOPING (value = 16), creature with this flag set will go back to the first waypoint, instead of walking reversely.</li>
  <li>Added new scripting function GetJournalQuestEntry into the 'nw_i0_plot' include file.</li>
  <li>Added new scripting function GetSlotByItem into the 'x2_inc_itemprop' include file.</li>
  <li>The internal spellhook (x2PreSpellCastCode()) moved from include to the normal script (70_spellhook) - this change will allow to change any part of the internal spellhook without need to recompile all spells, it should also improve efficiency a bit since the spellhook is now therefore cached.</li>
  <li>Fixed light not being properly removed after crafting an armor (x2_im_start_a).</li>
  <li>Fixed bug in 'SPAWN_CONDITION_FAST_BUFF_ENEMY' that prevented creatures to cast metamagically enhanced spells.</li>
  <li>Fixed losing the creature skin under the ILR/ELC settings. This fixes losing the mounted horse when relogging and other issues. (x2_mod_def_unequ)</li>
 </ul>
 <h2><a name="spellengine">New Spell Engine concept info</a> <span style="font-size: small;margin-top: -5px"><a href="#top">back to top</a></span></h2>
 <p>All spells and several feat/special ability scripts have been rewritten to use the new spell engine. This engine was developed by Shadooow as an attempt to make a system that is easy to understand and use and which would allowed to fix several spell exploits that couldn't be fixed nicely using the original spellscripts structure.<p>
 <p>Every serious builder that installed the Community Patch should upgrade his spell scripts onto new spell engine. Since the patch changed all spells and most of them have been altered significally, its recommended to make your spell changes again from scratch from community patch scripts. It's really easier than duplication the fixes that were done by Community Patch. To do it, you have to delete your current spellscript from your module and then open the spellscript from "All Resources". Then you get an upgraded version from community patch and you can incorporate your changes to that spell again.</p>
 <h3>Usage:</h3>
 <p>To use a new spell engine, you must include the 70_inc_spells library, possibly above all others includes with this line:</p>
 <p style="position: relative; left: 15px; color: #8b0000;">#include "70_inc_spells"</p>
 <p>With only including the spell engine library, you gain access to the spell structure containing all spell informations, but this structure must yet be initialized in the spellscript. Otherwise all spell informations will be at default values (0, OBJECT_INVALID, etc.). To initialize the new spell engine structure, add this line in the top of the spellscript (but under spellhook):</p>
 <p style="position: relative; left: 15px;">spellsDeclareMajorVariables();</p>
 <p>Now, you will be able to access spell related informations by typing:</p>
 <ul>
  <li>spell.Caster - caster</li>
  <li>spell.Target - spell target object</li>
  <li>spell.Item - spell cast item</li>
  <li>spell.Level - caster level</li>
  <li>spell.Id - spell ID constant</li>
  <li>spell.DC - spell DC</li>
  <li>spell.Meta - spell metamagic</li>
  <li>spell.Loc - spell target location</li>
  <li>spell.Class - spell cast class</li>
 </ul>
 <p>These "codes" behaves like any defined variables, so you can use them directly, but if you want to adjust them, eg. if the spell halves the caster level, it is good practice to declare the caster level into new variable beforehand like this:</p>
 <p style="position: relative; left: 15px;"><font color="blue">int</font> nCasterLevel = spell.Level/2;</p>
 <p>Otherwise you do not have to do this. Take a look into few spells that have been rewritten onto New Spell Engine and you will understand quicky.</p>
 <p class="red">Since version 1.71, the spell engine structure is global, so you can access and even modify all spell informations inside any function called by the original spell script such as MyResistSpell. Structure persists initialized even in delayed functions, so you don't need to pass caster level or spell id inside parameters anymore. The spell engine structure however won't persist between different scripts. Thus, in a spellhook or any other script executed from original spellscript, the spell engine structure will be uninitialized again and any modifications won't manifest into original spellscript.</p> 
 <h3>AOE spell scripts engine differences:</h3>
 <p>There is a special solution for AOE spells where most spell related information doesn't works or works improperly. First, you should use the function spellsSetupNewAOE in regular spell script, as a last line in that spell script. Example:</p>
 <p style="position: relative; left: 15px;">spellsSetupNewAOE("VFX_PER_ENTANGLE","nw_s0_entanglec");</p>
 <ul>
  <li>First parameter is optional, you can leave "", but for better safety it's recommend to write the tag of the AOE used in the spellscript. The tag always matches LABEL in vfx_persistent.2da .</li>
  <li>Second parameter is the name of the heartbeat script for AOE <i>(if any)</i> which is used for heartbeat workaround in modules where AOEs doesn't work well.</li>
 </ul>
 <p>This will enable full power of the new engine in AOE scripts. The AOE spells will work without doing this, but the <a href="#spellfeatures">spell-related features</a> won't work there at all. In these scripts you should use #include "70_inc_spells" again and initialize the spell engine by typing this line at top of the aoescript:</p> 
 <p style="position: relative; left: 15px;">aoesDeclareMajorVariables();</p>
 <p>And then you will be able to access spell related informations by typing:</p>
 <ul>
  <li>aoe.AOE - OBJECT_SELF, the AOE object</li>
  <li>aoe.Creator - caster of the spell that created the AOE</li>
  <li>aoe.Owner - actual owner of the mobile AOE, the one that is AOE centered to</li>
  <li>spell.Level - caster level</li>
  <li>spell.Class - spell cast class</li>
  <li>spell.Id - spell ID constant</li>
  <li>spell.DC - spell DC</li>
  <li>spell.Meta - spell metamagic</li>
 </ul> 
 <p>Other information are not accessable in AOE scripts and also, not needed.</p>
 <div class="red"><h2><a name="nwnx">NWNX Patch plugin</a> <span style="font-size: small;margin-top: -5px"><a href="#top">back to top</a></span></h2>
 <p>Community Patch also offers a NWNX plugins, called nwnx_patch (server-edition) and nwncx_patch (client-edition) that adds additional fixes and features. These plugins are dependant on the NWNX and NWNCX packages and won't work without it. Both plugins works standalone and doesn't require installing the Community Patch itself. Since the NWNX behaves differently on various operational systems, there is both windows and unix version of the nwnx_patch plugin. The client version works only under windows and supporting unix client isn't in plan. It's recommended to use WINE for playing NWN on unix OSes.</p>
 <p>Builders who want to use NWNX Patch plugin when hosting module with nwserver.exe needs the <a href="https://web.archive.org/web/20170227224729/http://nwnx.org/index.php?id=doc_nwnx">NWNX package</a>.
 <br>Players who want to use NWNCX Patch plugin needs the <a href="https://web.archive.org/web/20170227224729/http://www.neverwinternights.info/nwncx.htm">NWNCX package</a>. The client plugin works primarily only in single player and also in a LAN games, but certain features works even in multiplayer.</p>  
 <ul>Functionalities:
  <li>Enables to choose custom base class in initial character creation. [<b>C</b>,<b>M</b>]</li>
  <li>Increases the effect icons limit from 130 to 255. [<b>C</b>,<b>M</b>]</li>
  <li>Removed the limitation on weapon color from CopyItemAndModify function.[<b>C</b>,<b>S</b>]</li>
  <li>Fixes trident weapon focus bug. [<b>C</b>,<b>S</b>]</li>
  <li>Penalties to abilities from equipped items now properly ignores immunity to ability decrease.[<b>C</b>,<b>S</b>]</li>
  <li>Curse effect ignores immunity to ability decrease on a DnD Rules/Very High difficulty.[<b>C</b>,<b>S</b>]</li>
  <li>Circle kick has been changed to swap the target back after the extra attack on a different one.[<b>C</b>,<b>S</b>]</li>
 </ul>
 <p><b>Legend:</b> <b>C</b> = client version feature, <b>S</b> = server version feature, <b>M</b> = works also in a multiplayer</p>
 <h3>Usage:</h3>
 <p>Just to be sure - there is no installing of the plugins itself, you only need to put these files into folder with NWN. Though, you have to install the NWNX or NWNCX accordingly and run the game/server with them. They will automatically load the CP plugins. Both plugins creates the usual log files: nwnx_patch.txt in logs.0 folder and nwncx_patch in logs folder. Logs contains debug informations whether the plugin functionality works on not. It is possible that some Patch plugin functionalities won't work when using other plugins or in specifics OS environments such as 64bit - in this case report the problem on the CPP forums.</p></div>  
 <h2><a name="credits">Credits</a> <span style="font-size: small;margin-top: -5px"><a href="#top">back to top</a></span></h2>
 <ul>Community Patch contributors:
  <li><b>Shadooow</b> - founder, composer and main contributor of this project</li>
  <li><b>ILKAY</b> - Script, spell fix compilation and main advisor</li>
  <li><b>Mavrixio</b> - overfilled store issue workaround feature and main advisor</li>
  <li><b>Slasher</b> - secret placeables and main advisor</li>
  <li><b>Kubis</b> - 3rd party programmer, creator of the Auto 2DA Merger, Player character name inflecting tool for czech language and some nwscript functions</li>  
  <li><b>Aldark</b> - 3rd party programmer, creator of the windows installer</li>
  <li><b>Dark Defiance</b> - new main GUI and project icons</li>
  <li><b>Ben Harrison</b> - Familiar/animal companion fixes, Itemproperties expanded, dual wielding whip, dire boar and gorgon uv mapping fix</li>
  <li><b>NWNEnhanced team and Pstemarie</b> - many creature, placeable, item texture fixes and some secret placeables Slasher haven't found</li>
  <li><b>The Krit</b> - Familiar/animal companion fixes, Craft Magic Fixes</li>
  <li><b>Helvene</b> - many tileset fixes and improvements</li>  
  <li><b>Gerder</b> - sound fixes, few tileset fixes and few icons</li>
  <li><b>Kurairyu</b> - a better character hand and foot models</li>
  <li><b>DeathFace</b> - colorable lips, eyes and eyebrows</li>
  <li><b>Mordaedil</b> - Linu head fix and new immunity effects icons</li>                                                                        
  <li><b>The Amethyst Dragon</b> - custom emote icons and colored spell icons generation 2</li>
  <li><b>BoomWav</b> - colored skill and class icons</li>
  <li><b>Q-Necron</b> - colored clerical domain icons</li>                                                         
  <li><b>NWNWiki and its contributors</b> - know-how that allowed to fix many issues</li>
  <li><b>Realms of Mythology team</b> - item icon fixes</li>
  <li><b>Project Q team</b> - few tileset fixes</li>  
  <li><b>DOA team</b> - DOA pretty base item models.</li>
  <li><b>PRC Team</b> - inflict spells in onhit itemproperty, and few effect and spell icons.</li>
  <li><b>CEP1 team</b> - restoration of the secret Neverwinter Eye sword.</li>                                                                         
  <li><b>CEP2 team</b> - fix for missing fish placeable's portraits.</li>
  <li>and <b>Zwerkules</b>, <b>_six</b>, <b>TheSpiritedLass</b>, <b>BCH</b>, <b>henesua</b>, <b>Alex Warren</b>, <b>Squatting Monk</b>, <b>Melliuc</b>, <b>fire&ice;</b>, <b>kroko</b>, <b>Blackfire</b>, <b>Eldernurin</b>, <b>Jasperre</b>, <b>Somf</b>, <b>Blade Constantine</b>, <b>Old Time Radio</b>, <b>Chaos Theocrat</b>, <b>Grinning Fool</b>, <b>Gruftlord</b> and others...</li>
 </ul>
 <ul>Community Patch NWNX plugins contributors:
 <li><b>Shadooow</b> - Windows development.</li>
 <li><b>pope_leo</b> - Linux development.</li>
 <li><b>Mavrixio</b> - Circle kick fix.</li>
 </ul>  
 <ul>Languages:
 <li><b>Shadooow</b> - czech language translation, various fixes into old translation, 1.69 translation and total rewrite of all lines in order to allow language inflecting in OCs.</li>
 <li><b>Werelynx</b> and <b>Allex Warren</b> - polish language translation.</li>
 <li><b>Armelin</b> and <b>Aldark</b> - russian language translation.</li>
 <li><b>Zwerkules</b> - german language translation.</li>
 <li><b>Talon</b> - italian language translation.</li>
 </ul>
 <p>Special thanks also to everyone who supported this project in its early stages, to all betatesters and friends that were giving me good advices, ideas and bug reports.</p>
 </body>
</html>